#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±—ç–∫–µ–Ω–¥–∞ EventHub

cd "$(dirname "$0")/backend"

# –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –µ—Å–ª–∏ –µ—Å—Ç—å
if [ -d "venv" ]; then
    source venv/bin/activate
fi

# –£–±–∏–≤–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ –ø–æ—Ä—Ç—É 8000 –µ—Å–ª–∏ –∑–∞–Ω—è—Ç
lsof -ti:8000 | xargs kill -9 2>/dev/null

# –ó–∞–ø—É—Å–∫–∞–µ–º –±—ç–∫–µ–Ω–¥
echo "üöÄ –ó–∞–ø—É—Å–∫–∞—é –±—ç–∫–µ–Ω–¥ EventHub –Ω–∞ –ø–æ—Ä—Ç—É 8000..."
python3 -m uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload

